---
title: Аптымістычныя масты
date: 2021-06-06T00:03
---

#### Новая парадыгма кросчэйн-камунікацый

![](/blog/4/1.jpg)

Пару месяцаў таму мы абвясцілі аб [цесным партнёрстве з Nomad](https://blog.connext.network/connext-has-partnered-with-nomad-e20cd8e62e31), межсеткавым пратаколам сувязі, які выкарыстоўвае доказы махлярства (па аналогіі з [Optimistic Rollups](https://ethereum.org/en/developers/docs/scaling/optimistic-rollups/)) для перадачы дадзеных паміж ланцужкамі.

У гэтым пасту мы падрабязна разгледзім, як працуюць аптымістычныя масты, якія іх недахопы і за што мы іх любім.

#### Рэзюмэ: трылема функцыянальнай сумяшчальнасці

Трылема [функцыянальнай сумяшчальнасці](https://blog.connext.network/the-interoperability-trilemma-657c2cf69f17) — гэта мадэль, якая тлумачыць кампрамісную прастору вакол маста з класіфікацыяй існуючых сёння тыпаў пратаколаў межсеткавай сувязі.

![](/blog/4/2.png)

Калі мы пісалі аб трылеме ў прошлым годзе, мы падзялілі масты на тры тыпы ў залежнасці ад таго, як яны правяраюцца:

*   Лакальная праверка (атамарныя абмены і сістэмы хуткай ліквіднасці)
*   Знешняя праверка (мультыподпіс, пратаколы канфідэнцыйных вылічэнняў (mpc), парог, доказ долі(PoS) і масты валідатараў (вузлоў сеткі))
*   Натыўная праверка (загаловак рэле лёгкага кліенту, масты rollup)

У кожным выпадку механізм праверки прыводзіў да кампрамісу як мінімум у АДНЫМ з трох жадаемых уласцівасцяў:

*   Мінімізацыя даверу: даданне толькі тых здагадак аб эканамічнай бяспецы, якія выкарыстоўваюцца ў базавым ланцужку.
*   Абагульняльнасць: падтрымка перадачы адвольных дадзеных па ланцужкам.
*   Пашыральнасць: магчымасць разгортвання ў многіх неаднародных ланцужках з мінімальнай працай па наладзе.

#### Аптымістычная праверка

У адрозненне ад мастоў з лакальнай, знешней ці уласнай праверкай, аптымістычныя масты выкарыстоўваюць новы кампраміс: **затрымку**.

![](/blog/4/3.png)

  

Вось як яны працуюць на высокім узроўні:

1.  Як і ў выпадку з іншымі мастамі, дадзеныя публікуюцца ў ланцужку паходжання ў функцыю кантракта карыстальнікам ці дэцэнтралізаваным дадаткам (dApp).
2.  Агент, названы механізмам **абнаўлення**, падпісвае корань меркла (merkle root), які змяшчае дадзеныя з (1), і адпраўляе іх у зыходны ланцужок. Як і ў выпадку з назапашвальнікам, механізм абнаўлення звязвае сродкі, якія уразаюцца ў выпадку махлярства.
3.  На гэтым этапе любая сістэма рэтрансляцыі (напрыклад, [Gelato](http://gelato.network/), [Keep3r](https://keep3r.network/), [Biconomy](https://biconomy.io/) і г.д.) можа прачытаць гэты корань у ланцужку крыніцы і адправіць яго ў адну ці некалькі ланцужкоў прызначэння.
4.  Адпраўка дадзеных у ланцужок прызначэння запускае 30-хвіліннае акно абароны ад махлярства (аналагічна выходнаму акну **Optimistic Rollup**). На працягу гэтага часу любы, хто назірае за ланцужком (**назіральнік**), можа даказаць махлярства ў зыходным ланцужку і адключыць канал сувязі з пунктам прызначэння. Калі гэта адбываецца, сувязь, якая абнаўляе праграмы, скарачаецца, г. зн. іх сродкі адбіраюцца і перадаюцца назіральніку на разгляд.
5.  Калі на працягу 30 хвілін не будзе пацверджана махлярства, дадзеныя, перададзеныя ў ланцужок прызначэння, могуць лічыцца завершанымі і выкарыстанымі дадаткам. Як правіла, гэта адбываецца, калі пастаўшчык паслуг (**працэсар**) адпраўляе доказ Меркла дадзеных для маста, а затым выкарыстоўвае гэтыя дадзеныя для выкліку функцыі кантракту ў ланцужку прызначэння.

Паколькі перадаюцца дадзеныя абсалютна адвольныя, аптымістычныя масты дазваляюць нам ствараць _кросчэйн-дадаткі/прэцэдэнты любога тыпу з мінімальным даверам_. Некалькі прыкладаў:

*   Блакаванне і эмісія токенаў або спальванне і эмісія токенаў.
*   Злучэнне ліквіднасці DEX паміж ланцужкамі ў адзіным бясшвоўным транзакцыйным паведамленні (tx).
*   Запуск кросчэйн-сховішча і кіраванне стратэгіяй сховішча.
*   Крытычныя аперацыі пратаколу, такія як рэплікацыя/сінхранізацыя глабальных канстант (напрыклад, PCV) паміж сеткамі.
*   Даданне TWAP UniV3 у кожны ланцужок без увядзення аракулаў.
*   Незалежнае ад сеткі кіраванне veToken.
*   Сумяшчальнасць метасусвету з метасусветамі.

#### Мадэль эканамічнай бяспекі

Падобна аптымістычным ролапам і станам каналаў сетак, аптымістычныя праекты мастоў належаць на групу назіральнікаў, якія сочаць за ланцужком і паведамляюць аб махлярстве. Гэта прынцыпова іншая мадэль бяспекі, чым масты з вонкавай праверкай, гэтак жа, як назапашвальныя пакеты маюць прынцыпова іншую мадэль бяспекі, чым сайдчэйны.

#### Крыптаэканоміка мастоў з вонкавай праверкай

Вонкава правераныя масты (г. зн. мультыподпіс, валідатар, PoS, mpc ці парог) (і самі сайдчэйны/L1!) выкарыстоўваюць дапушчэнне сумленнай большасці - іншымі словамі, `m of n` удзельнікі сістэмы павінны правільна правяраць абнаўленні. З пункту гледжання крыптаэканомікі гэта азначае:

> Кошт нападу на вонкава правераны мост з дапамогай `n` верыфікатараў роўная кошту пашкоджання або ўзлому `m` верыфікатараў.

Важна адзначыць, што гэта _новы_ патэнцыйны вектар для нападу - калі эканамічная бяспека маста не перавышае кошт 51% нападу на ланцужок, гэта абавязкова азначае, што вонкава правераны мост дадае (часта значнае) даверная здагадка.

У якасці альтэрнатывы поўная эканамічная бяспека маста, праверанага звонку, можа быць дасягнута, калі сістэма можа (а) надзейна даказаць махлярства і (б) вярнуць карыстачам поўную суму ўсіх актываў, якія могуць быць страчаныя ў выніку ўзлому. Іншымі словамі, карыстачы і/ці LP могуць быць застрахаваны толькі ў тым выпадку, калі кошт скарачанай дзелі (напрыклад, у RUNE на Thorchain) больш або роўная TVL усёй сістэмы. Звярніце ўвагу, што (а) з'яўляецца моцнай здагадкай - канчатковае доказ махлярства тут само па сабе патрабуе надзейнага механізму міжланцуговай сувязі, што робіць праблему некалькі рэкурсіўнай.

#### Крыптаэканоміка аптымістычных мастоў

Шаблон "назіральнік + абарона ад махлярства", з іншага боку, выкарыстоўвае **адзінае** дапушчэнне сумленнага верыфікатара. Іншымі словамі, аптымістычныя масты патрабуюць, каб `1 of n` бакі ў сістэме правільна правяралі абнаўленні.

> Кошт нападу аптымістычнага маста з дапамогай `n` верыфікатараў роўны кошту пашкоджання або ўзлому `n` верыфікатараў.

Калі назіральнікі для аптымістычнай сістэмы (няхай гэта будзе зводкі, каналы ці масты) не маюць доступу (і мы мяркуем, што базавы ланцужок працуе), то **эканамічныя выдаткі на напад сістэмы неабмежаваны**. Гэта звязана з тым, што немагчыма быць упэўненым, што ў свеце няма хаця б аднаго назіральніка, які працуе ананімна, які можа даказаць махлярства.

Гэта мае вельмі цікавае наступства:

У аптымістычным мосце EV(Enterprise Value) спробы махлярства **заўсёды** адмоўнае, таму што, пакуль базавыя ланцужкі бяспечныя, ніякія грошы не могуць гарантаваць поспех вашага нападу. Такім чынам, сума скарачанай стаўкі, якая павінна быць прывязана да праграмы абнаўлення, павінна быць дастаткова высокай, каб прадухіліць спробы махлярства (г. зн. спыніць грыферства (шкодніцтва)).

Вось чаму секвенсорам ORU, напрыклад, трэба звязаць толькі невялікае падмноства агульнага TVL скруткі.

#### Рэжымы адмовы

_Магчыма, найболей важнай перавагай аптымістычных мастоў у параўнанні з мастамі, якія прайшлі знешнюю праверку_, з'яўляецца кампраміс паміж _жывучасцю_ і бяспекай. Іншымі словамі, пакуль сама базавая ланцужок бяспечная, тэарэтычны найгоршы сцэнар – гэта ўжо **не страта сродкаў**, а прыпынак сістэмы.

#### DoS-напады на праграму абнаўлення

Падобна назапашвальнага секвенсору, цэнтралізаваны сродак абнаўлення можа зламысна або выпадкова спыніць сістэму, калі яна перастане падпісваць абнаўленні.

Аднак дэцэнтралізацыя сродкі абнаўлення Nomad даволі простая задача. Простым прыкладам канструкцыі можа быць наяўнасць мноства злучаных сродкаў абнаўлення (а не аднаго) і выкарыстанне цыклічнага падыходу да падпісання абнаўленняў з адпрацоўкай адмовы і скарачэннем, калі дадзены сродак абнаўлення прапускае свой "ход".

#### Махлярства з праграмай абнаўлення

Любыя дадзеныя, якія перадаюцца па ланцужках у аптымістычным мосце, павінны быць падпісаны сродкам абнаўлення, а гэта азначае, што любое махлярства ў сістэме таксама павінна зыходзіць ад сродку абнаўлення.

У аптымістычных мастах махлярства заўсёды дэтэрміністычна даказальна ў зыходным ланцужку (аналагічна таму, як махлярства ORU заўсёды даказальна ў L1). Для гэтага назіральнік проста павінен прадставіць доказ недапушчальнага абнаўлення кантракта ланцужка паходжання, што затым прыводзіць да скарачэння сродку абнаўлення. Затым назіральнік адпраўляе падпісанае паведамленне ў ланцужок прызначэння, каб "адключыць" канал сувязі на працягу 30 хвілін (да таго моманту, калі гэтыя ашуканскія дадзеныя можна лічыць завершанымі).

Насамрэч няма неабходнасці даказваць махлярства ў ланцужку прызначэння. Правільнае выкананне гэтага ў хатнім ланцужку карае сродак абнаўлення, якое ў першую чаргу перашкаджае махлярству, а наступнае адключэнне канала сувязі змяншае любую патэнцыйную шкоду. Тым не менш, магчымасць назіральніка адвольна адключыць канал сувязі адчыняе вектар DoS, які мы абмяркуем ніжэй.

#### Назіральнік DoS

Паколькі любы назіральнік можа ініцыяваць адключэнне канала сувязі ў аптымістычным мосце, назіральнікі могуць сапсаваць/назаўжды спыніць дадзены канал сувязі, рассылаючы спам аб адключэннях. Звярніце ўвагу, што назіральнікі нічога не атрымліваюць ад сістэмы, робячы гэта (любыя сродкі/дадзеныя застаюцца ў бяспецы), і рызыка гэтага размяркоўваецца _па каналах сувязі_ (г. зн. адключэнне аднаго канала не прывядзе да адключэння сістэмы ў цэлым).

![](/blog/4/4.gif)

Хопіць адключаць мае каналы, Біл!

Гэты тып нападу можна змякчыць у доўгатэрміновай перспектыве, увёўшы правільныя віды стымулаў для назіральнікаў. Паколькі назіральнікі зарабляюць зрэзаную сувязь назіральніка пры правільным аспрэчванні, мы можам змякчыць нанесеную шкоду назіральнікам, увёўшы базавы падатак для назіральнікаў за ініцыяванне доказаў махлярства. Гэты падатак павінен быць (а) дастаткова высокім, каб не стымуляваць спам, але таксама (б) дастаткова нізкім у параўнанні з закладам асобы, якая ажыццяўляе абнаўленне, каб у назіральнікаў ўсё яшчэ быў моцны стымул ініцыяваць сапраўдныя доказы махлярства. Іншым простым рашэннем было б проста апублікаваць подпіс аб адключэнні, згенераваны назіральнікам, у хатнім ланцужку і адключыць назіральніка, калі махлярства не можа быць даказана.

На дадзены момант Nomad вырашае гэтую праблему, дазваляючы набор назіральнікаў. Гэта змяняе эканамічную бяспеку сістэмы, таму што зараз ёсць фіксаваны/вядомы набор назіральнікаў, якія могуць быць пашкоджаны (такім чынам абмяжоўваючы кошт нападу). Тым не менш, мы лічым гэта прымальным часовым рашэннем, паколькі існуе _прамы і вельмі надзейны шлях да мінімізацыі даверу_. Гэты падыход таксама адлюстроўвае тое, як былі разгорнуты іншыя сістэмы абароны ад махлярства:

*   Стан сеткі каналаў гістарычна пачыналіся з дазволенага назіральніка, настроенага на змякчэнне сапраўды такога ж тыпу вектараў шкодніцтва, пакуль не будзе створаны правільны тып стымулаў.
*   Аптымістычныя назапашвальныя пакеты ў цяперашні час знаходзяцца на этапе пачатковай загрузкі таго ж тыпу, калі сродкі абароны ад махлярства і аспрэчванні яшчэ не актываваны. Хоць гэта азначае, што ў цяперашні час назапашвальныя пакеты карыстаюцца вялікім даверам, шырэйшая супольнасць разумее, што гэта ўсяго толькі часавая фаза «навучальных колаў», пакуль рэалізацыі не стануць больш сталымі.

#### Збоі жыццяздольнасці ланцуга

Асноўная здагадка, якую мы абмяркоўвалі вышэй, складаецца ў тым, што самі базавыя ланцужкі здольныя прымаць транзакцыі ад назіральнікаў. Гэтая здагадка аднолькава для любой сістэмы, заснаванай на абароне ад махлярства, дзе тыповая канструкцыя мае некаторае акно доказу, на працягу якога назіральнікі **павінны** завяршыць транзакцыю для ланцужка.

Nomad параметрызаваў сваю 30-хвілінную затрымку на [аснове існуючых даследаванняў кошту атакі імавернасных ланцужкоў завершанасці](https://medium.com/offchainlabs/fighting-censorship-attacks-on-smart-contracts-c026a7c0ff02). Мы пастараемся разабраць даследаванні/логіку гэтай параметрызацыі ў будучым паведамленні ў блогу.

#### Параўнанне з іншымі падыходамі

У кожнай размеркаванай сістэмы ёсць свае недахопы - **у маставым злучэнні не бывае бясплатных абедаў**. Безумоўна, найболей абуральным кампрамісам аптымістычных сістэм з'яўляецца даданне 30-хвіліннай затрымкі для перадачы, хоць мы лічым, што гэта можна змякчыць, [выкарыстаючы модульную канструкцыю, у якой Connext накладваецца](https://blog.connext.network/connext-has-partnered-with-nomad-e20cd8e62e31?source=collection_home---4------2-----------------------) паверх (падрабязней пра гэта хутка!).

**M з N мастоў**

Як мы паказалі вышэй, аптымістычныя масты прапануюць значны крок наперад у плане бяспекі і мінімізацыі даверу ў параўнанні з мастамі з вонкавай праверкай (мультыподпіс, парогавае значэнне, mpc або набор валідатараў). Мадэль `1 of N` бяспекі аптымістычных мастоў можа змякчыць разбуральныя вектары нападаў, звязаныя са змовай або скампраметаванымі ключамі.

Напрыклад, узлом Ronin Bridge коштам 625 мільёнаў даляраў быў бы немагчымы, калі б Ронін выкарыстоўваў аптымістычны мост, нават калі б усе ключы былі скампраметаваныя.

![](/blog/4/5.png)

Аналагічнае параўнанне можна правесці з LayerZero, у якім выкарыстоўваюцца два перакрываюцца `m of n` набору, якія функцыянальна дзейнічаюць проста як большы `m of n` набор (дзе памер набору ўдзельнікаў і вектары змовы становіцца цяжэй разважаць, калі не вядома асоба ўсіх удзельнікаў абодвух набораў).

#### Атамарныя абмены і хуткая ліквіднасць

Лакальна правераныя сістэмы (такія як [бягучая рэалізацыя Connext nxtp](https://github.com/connext/nxtp)), хоць і не патрабуюць даверу і простыя ў разгортванні, як аптымістычныя масты, не падтрымліваюць адвольную перадачу дадзеных па ланцужках.

У гэтым сэнсе яны саступаюць аптымістычным мастам ва ўсім, акрамя пераводу сродкаў і простага выканання кантракту. Тым не менш, цалкам верагодна, што яны па-ранейшаму будуць заставацца вельмі карыснымі ў якасці механізма для змякчэння іншых недахопаў аптымістычных мастоў, а менавіта затрымкі.

#### Рэле загалоўка

Сістэмы рэтрансляцыі загалоўкаў лёгкага кліента, такія як IBC, працуюць шляхам праверкі кансенсусу ланцужкі B ўнутры віртуальнай машыны ланцужкі A. Рэтранслятары загалоўкаў даюць нам тэарэтычна лепшыя ў сваім класе здагадкі аб даверы, паколькі наборы валідатараў кожнага базавага ланцужка правяраюць адзін аднаго - без дадатку адрозненне ад вонкава правераных мастоў) ці здагадкі аб жывучасці (як аптымістычныя масты). Яны таксама не абавязаны ісці на кампраміс з затрымкай, як аптымістычныя масты.

Тым не менш, рэтранслятары загалоўкаў не пазбаўлены сваіх праблем:

*   Для кожнага новага механізму ланцужкі/кансенсусу неабходна стварыць уласны лёгкі кліент.
*   [У прыватнасці, для Ethereum PoW кошт праверкі кансэнсусу надмерна высокая з-за высокіх патрабаванняў да памяці.](https://eth.wiki/concepts/ethash/design-rationale)
*   Рэле загалоўкаў можа не працаваць з аптымістычнымі згортваннямі з-за рызыкі адкату - аднак гэта вызначана адкрытая вобласць даследаванняў!

#### ZK Мосты

Нягледзячы на ​​тое, што ў крыпта-прасторы пакуль не існуе надзейных мастоў ZK, можна ствараць масты на аснове доказаў з нулявым разгалашэннем, якія выкарыстоўваюць тую ж стратэгію, што і рэтранслятары загалоўкаў, для праверкі дадзеных у ланцужках.

Падобна рэтранслятарам загалоўкаў, масты zk маюць вялікі давер і нізкую затрымку. Яны таксама, верагодна, нашмат танней, чым звычайныя сістэмы рэтрансляцыі загалоўкаў, таму што пацвярджэнне кансэнсусу больш не павінна адбывацца ў ланцужку. Аднак пры гэтым яны ўводзяць некаторыя новыя кампрамісы:

*   Як і ў выпадку рэтрансляцыі загалоўкаў лёгкага кліента, для праверкі кансенсусу для кожнага ланцужка павінна быць разгорнута спецыяльная стратэгія, і, магчыма, яны ўвогуле не будуць працаваць для ORU. Для мастоў zk гэта яшчэ складаней, улічваючы, што не ўсе ланцужкі рэалізуюць адны і тыя ж крыптаграфічныя прымітывы.
*   Насамрэч немагчыма даказаць усе мадэлі кансэнсусу з нулявым разгалашэннем. У гэтых выпадках неабходны нейкі гаджэт канчатковасці, які дадае новыя здагадкі аб даверы.

Цалкам верагодна, што існуюць і іншыя недахопы, злучаныя з коштам прувера і даступнасцю дадзеных, хоць яны яшчэ не былі старанна даследаваны.

#### Будучыня мастоў аптымістычна

Да гэтага часу ў нас не было эканамічных у вылічальных адносінах механізмаў для перадачы адвольных дадзеных па ланцужках, якія не ўключалі б давераных іншых верыфікатараў. Аптымістычныя масты забяспечваюць вельмі высокі ўзровень бяспекі / мінімізацыі даверу, захоўваючы пры гэтым прастату і лёгкасць разгортвання існуючых мультыподпісных мастоў.

Па гэтай прычыне мы неверагодна ўсхваляваныя Nomad і думаем, што гэта вялізны крок наперад для кроссчейн і крыжаванай камунікацыі.

#### Аб Nomad

Nomad - гэта новы кірунак для радыкальна таннейшай міжсеткавай сувязі без праверкі загалоўкаў. Ён сфарміруе базавы ўзровень кроссчейн-камунікацыйнай сеткі, якая забяспечыць хуткую і танную сувязь для ўсіх ланцужкоў смарт-кантрактаў і аб'яднанняў.

Пратакол узаемадзеяння Nomad працуе ў асноўнай сетцы Ethereum, Moonbeam і Milkomeda, і неўзабаве плануецца разгарнуць яго ва ўсіх асноўных сетках.

[Веб-сайт](https://www.nomad.xyz/) | [Дакументацыя](https://docs.nomad.xyz/) | [Twitter](https://twitter.com/nomadxyz_) | [Discord](https://discord.gg/RurtmJApqm) | [Github](https://github.com/nomad-xyz/nomad-monorepo) | [Blog](https://medium.com/@nomadxyz)

#### Аб Connext

Connext – гэта сетка для хуткай і надзейнай сувязі паміж ланцужкамі і ралапамі. Гэта адзіная сістэма ўзаемадзеяння ў сваім родзе, якая робіць гэта танна і хутка, не гаворачы аб даверы. Connext прызначаны для распрацоўшчыкаў, якія хочуць ствараць масты і іншыя кросчэйн-прыкладанні. На сённяшні дзень праз сетку прайшло больш за 1,3 мільярда долараў транзакцый.

[Веб-сайт](https://www.connext.network/) | [Дакументацыя](https://docs.connext.network/) | [Twitter](https://twitter.com/connextnetwork) | [Discord](https://discord.gg/raNmNb5) | [Github](https://github.com/connext) | [Blog](https://medium.com/connext)

_Вялікі дзякуй Ганна Кэрал, Джэймс Прэствіч, Пранай Мохан, а таксама астатнюю частку каманды Nomad за ідэі і водгукі, якія спрыялі напісанню гэтага пасту!_
